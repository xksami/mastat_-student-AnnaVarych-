---
title: "Лабораторна робота 4"
author: "Anna Varych, KN-23-1, `r format(Sys.Date(), '%Y')`"
date: "`r Sys.Date()`"
output:
#   pdf_document:
#     highlight: tango
#     toc: yes
#   word_document:
#     highlight: tango
#     toc: yes
# always_allow_html: true
  html_notebook:
    # citation_package: natbib
    toc: yes # Оглавление
    toc_float: true
    highlight: tango # Цвет подсветки кода
fontsize: 12pt # размер шрифта
header-includes:
 \usepackage[T2A]{fontenc}
 \usepackage[utf8]{inputenc}
 \usepackage[russian]{babel}
editor_options: 
  chunk_output_type: console

---
## Постановка задачі

Випадкова величина $X$ має заданий закон розподілу, вектор параметрів якого відомий. Необхідно згенерувати вибірку випадкової величини $X = (x_1, \dots, x_n)$, спочатку об'єму $n = 50$, обчислити оцінку вектора параметрів розподілу та перевірити гіпотезу щодо нормальності розподілу за допомогою статистичних критеріїв.

### Опис рівномірного розподілу

Для випадкової величини $X$ з рівномірним розподілом на відрізку $[a, b]$, функція щільності ймовірності виглядає наступним чином:


$f(x) = \frac{1}{b - a}, \quad \text{для } a \leq x \leq b$


де $a = 0$, $b = 1$.

## Розв'язок задачі

### Генерація вибірки

Спочатку згенеруємо вибірки з рівномірного розподілу для двох випадків: для $n = 50$ та $n = 1000$.


```{r}
# Генерація вибірки з рівномірного розподілу
set.seed(123)
n50 <- runif(50, min = 0, max = 1)
n1000 <- runif(1000, min = 0, max = 1)

# Перегляд перших 5 елементів вибірок
head(n50)
head(n1000)
```



```{r}
# Оцінка параметрів для n = 50
mean50 <- mean(n50)
var50 <- var(n50)

# Оцінка параметрів для n = 1000
mean1000 <- mean(n1000)
var1000 <- var(n1000)

mean50
var50
mean1000
var1000
```



```{r}
# Перевірка на нормальність для вибірки n = 50
shapiro_test_50 <- shapiro.test(n50)

# Перевірка на нормальність для вибірки n = 1000
shapiro_test_1000 <- shapiro.test(n1000)

shapiro_test_50
shapiro_test_1000
```

```{r}
# Гістограма для n = 50
hist(n50, prob = TRUE, main = "Гістограма для n = 50", xlab = "X", col = "lightblue", border = "black")
curve(dunif(x, min = 0, max = 1), col = "red", lwd = 2, add = TRUE)

# Гістограма для n = 1000
hist(n1000, prob = TRUE, main = "Гістограма для n = 1000", xlab = "X", col = "lightgreen", border = "black")
curve(dunif(x, min = 0, max = 1), col = "red", lwd = 2, add = TRUE)

# Q-Q Plot для n = 50
qqnorm(n50, main = "Q-Q Plot для n = 50")
qqline(n50, col = "red")

# Q-Q Plot для n = 1000
qqnorm(n1000, main = "Q-Q Plot для n = 1000")
qqline(n1000, col = "red")


```

```{r}
# Функція для оцінки асиметрії та ексцесу
sample_moments <- function(x) {
  n <- length(x)
  mean_x <- mean(x)
  sd_x <- sd(x)
  
  skewness <- sum((x - mean_x)^3) / (n * sd_x^3)
  kurtosis <- sum((x - mean_x)^4) / (n * sd_x^4) - 3
  
  skewness_std <- skewness * sqrt(n / 6)
  kurtosis_std <- kurtosis * sqrt(n / 24)
  
  # Форматований вивід
  cat("Середнє:", mean_x, "\n")
  cat("Дисперсія:", var(x), "\n")
  cat("Асиметрія:", skewness, "\n")
  cat("Ексцес:", kurtosis, "\n")
  cat("Стандартизована асиметрія:", skewness_std, "\n")
  cat("Стандартизований ексцес:", kurtosis_std, "\n")
}

# Використовуємо функцію для вибірки n = 50
sample_moments(n50)

# Використовуємо функцію для вибірки n = 1000
sample_moments(n1000)
```

## Висновки

1. **Генерація вибірок**:
   - Згенеровані вибірки з рівномірного розподілу на інтервалі $[0, 1]$ для $n = 50$ та $n = 1000$ показали, що з кількістю спостережень збільшення вибірки призводить до більш точних оцінок математичного сподівання та дисперсії.
   
2. **Оцінка параметрів**:
   - Оцінки середнього значення та дисперсії для обох вибірок наближаються до значень, що очікуються для рівномірного розподілу: середнє $ \approx 0.5 $, дисперсія $ \approx 1/12 $. 
   
3. **Перевірка на нормальність**:
   - Для вибірки з $n = 50$ тест Шапіро-Уілка вказав на відхилення від нормального розподілу (p-значення менше 0.05), тому гіпотезу про нормальність було відхилено.
   - Для вибірки з $n = 1000$ тест показав, що гіпотеза про нормальність не відкидається (p-значення більше 0.05), що підтверджує можливість нормального розподілу при великій кількості спостережень.

4. **Графічний аналіз**:
   - Гістограми та Q-Q графіки підтвердили результати тесту на нормальність: для малих вибірок (n = 50) розподіл не є нормальним, але для великих вибірок (n = 1000) дані більш схожі на нормальний розподіл.

5. **Асиметрія та ексцес**:
   - Оцінки асиметрії та ексцесу для вибірок виявилися близькими до значень, очікуваних для рівномірного розподілу. Стандартизовані значення асиметрії та ексцесу знаходяться в межах нормальних значень, що вказує на відсутність значних відхилень від рівномірного розподілу.

6. **Загальний висновок**:
   - Результати дослідження підтверджують, що для великої вибірки (n = 1000) дані близькі до рівномірного розподілу, що робить можливим використання рівномірного розподілу для моделювання випадкових величин у таких умовах.
